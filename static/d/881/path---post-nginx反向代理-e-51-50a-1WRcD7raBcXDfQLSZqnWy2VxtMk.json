{"data":{"markdownRemark":{"html":"<p>这里以部署一个<code>code-to-image</code>为例子，实例演示如何使用 Nginx 反向代理。</p>\n<h1>设置子域名</h1>\n<p>首先你的设置一个子域名和云解析，例如: code2img.domain.com</p>\n<blockquote>\n<p>code2img.test.com 只是为了演示，实际操作请换成你的域名。</p>\n</blockquote>\n<p>我使用的阿里云</p>\n<p><img src=\"../imgs/nginx-1.jpg\"></p>\n<p>点击添加云解析</p>\n<p><img src=\"../imgs/nginx-2.jpg\"></p>\n<p>在主机记录输入子域名名。</p>\n<p>记录值填入云服务器 IP 地址。</p>\n<p>其余一般默认即可，点击确认。</p>\n<p><img src=\"../imgs/nginx-3.png\"></p>\n<p>一个子域名添加完成。</p>\n<h1>Nginx 代理</h1>\n<p>这里我使用的 LNMP。添加一个子域名就非常简单。</p>\n<p>执行</p>\n<pre><code class=\"language-shell\">lnpm vhost add\n</code></pre>\n<p>所有选项全部默认就行。</p>\n<p><img src=\"../imgs/nginx-4.png\"></p>\n<p>进入<code>/usr/local/nginx/conf/vhost</code>目录</p>\n<p>将<code>code2img.test.com.conf</code>改为一下内容</p>\n<pre><code class=\"language-conf\">upstream dome {\n        server 127.0.0.1:8080;\n}\nserver\n    {\n        listen 80;\n        #listen [::]:80;\n        server_name code2.img.test.com ;\n        index index.html index.htm index.php default.html default.htm default.php;\n        root  /home/wwwroot/code2.img.test.com;\n\n        location / {\n            proxy_pass http://127.0.0.1:8080/;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwaraed-For $proxy_add_x_forwarded_for;\n        }\n\n        include none.conf;\n        #error_page   404   /404.html;\n\n        # Deny access to PHP files in specific directory\n        #location ~ /(wp-content|uploads|wp-includes|images)/.*\\.php$ { deny all; }\n\n        include enable-php.conf;\n\n        location ~ .*\\.(gif|jpg|jpeg|png|bmp|swf)$\n        {\n            proxy_pass http://127.0.0.1:8080;\n            expires      30d;\n        }\n\n        location ~ .*\\.(js|css)$\n        {\n            proxy_pass http://127.0.0.1:8080;\n            expires      12h;\n        }\n\n        location ~ /.well-known {\n            allow all;\n        }\n\n        location ~ /\\.\n        {\n            deny all;\n        }\n\n        access_log  /home/wwwlogs/code2.img.test.com.log;\n    }\n</code></pre>\n<p>最后重启 LNMP 就可以了。</p>\n<pre><code class=\"language-shell\">lnmp restart\n</code></pre>\n<p>现在访问<a href=\"https://code2img.test.com\">https://code2img.test.com</a>就可以使用<code>code-to-img</code>了。</p>\n<p> 参考</p>\n<ul>\n<li><a href=\"http://www.nginx.cn/927.html\">http://www.nginx.cn/927.html</a></li>\n<li><a href=\"https://lnmp.org/faq/lnmp-vhost-add-howto.html\">LNMP 添加虚拟主机</a></li>\n</ul>","frontmatter":{"title":"Nginx 反向代理"}}},"pageContext":{"slug":"/post/Nginx反向代理","pre":"/post/基于gogs的自主git服务","next":"/post/why-dont-choice-ruby","tags":["wabpack","eslint","javascript","axios","api","react","babel","algorihm","linix","app","git","gogs","nginx","proxy","ruby","language","php","shell","cpp","language-feature","c","recursion","java","jsp","mysql","atom","markdown","nodejs","error"]}}